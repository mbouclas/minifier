var baseUrl="",urls={boot:baseUrl+"boot.php?init=1",loader:"../ajax/loader.php",login:baseUrl+"login.php",save:"saveTemplate.php"},appData={},mcms=angular.module("mcms",["mcmsServices"]);angular.module("mcmsServices",[]).factory("xhr",["$rootScope","$http","$location","$q",function(a,d,c,b){d.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded";return{boot:function(){var a=b.defer();d.get(urls.boot,{}).success(function(b){a.resolve(b)});return a.promise},login:function(a){var c=b.defer();d.post(urls.login,$.param(a)).success(function(a){c.resolve(a)});return c.promise},save:function(a){var c=b.defer();d.post(urls.save,$.param(a)).success(function(a){c.resolve(a)});
return c.promise},readFile:function(a){var c=b.defer();d.get(a,{}).success(function(a){c.resolve(a)});return c.promise}}}]).factory("socket",["$rootScope",function(a){var d=io.connect("http://localhost:3003");return{on:function(c,b){d.on(c,function(){var c=arguments;a.$apply(function(){b.apply(d,c)})})},emit:function(c,b,g){d.emit(c,b,function(){var b=arguments;a.$apply(function(){g&&g.apply(d,b)})})}}}]);mcms.directive("loadingMessage",function(){return{restrict:"A",transclude:!0,priority:1E3,template:'<div>\n  <div class="overlay-container" ng-show="message">\n    <div class="overlay-text" ng-bind="message"></div>\n  </div>\n  <div ng-transclude></div>\n</div>',link:function(a){a.$watch("loading",function(d){a.message=d?a.loadingMessage||"Loading...":""})}}});
mcms.directive("ngIf",function(){return{priority:500,restrict:"A",transclude:"element",compile:function(a,d,c){var b=d.ngIf;return function(a,d){var e,f;a.$watch(b,function(b){e&&(f.$destroy(),e.remove(),e=f=null);b&&c&&(f=a.$new(),c(f,function(a){e=a;d.after(a)}))})}}}});mcms.controller("mainCtrl",["$scope","$rootScope","socket",function(a,d,c){a.dir="./";a.files=[];a.allFiles=[];a.projectFiles=[];a.openedFiles=[];a.root={};c.on("dirResults",function(b){if("undefined"==typeof a.root.file)a.files=b,a.allFiles=b;else{for(var c in b)a.allFiles.push(b[c]);a.files[a.allFiles.indexOf(a.root)].children=b}});c.on("fileReady",function(){a.downloadFile=!0});a.getFiles=function(){c.emit("send:files",{dir:a.dir})};a.getFiles();a.open=function(b){-1!=a.openedFiles.indexOf(b)?
b.shown=!0===b.shown?!1:!0:(b.shown=!0,a.openedFiles.push(b),b.children=[],a.root=b,c.emit("send:files",{dir:b.file}))};a.addFile=function(b){a.projectFiles.push(b)};a.compress=function(){c.emit("compress",{fileOut:a.fileOut,files:a.projectFiles})}}]);
